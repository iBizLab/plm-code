System.register(["sortablejs","vue"],function(v){"use strict";var f,x,b,y,u,m;return{setters:[function(a){f=a.default},function(a){x=a.resolveComponent,b=a.TransitionGroup,y=a.defineComponent,u=a.h,m=a.nextTick}],execute:function(){function a(t){t.parentElement!==null&&t.parentElement.removeChild(t)}function C(t,e,n){const o=n===0?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,o)}function A(){return typeof window<"u"?window.console:global.console}const U=A();function k(t){const e=Object.create(null);return function(o){return e[o]||(e[o]=t(o))}}const O=/-(\w)/g,T=k(t=>t.replace(O,(e,n)=>n.toUpperCase())),_=["Start","Add","Remove","Update","End"],I=["Choose","Unchoose","Sort","Filter","Clone"],E=["Move"],j=[E,_,I].flatMap(t=>t).map(t=>`on${t}`),h={manage:E,manageAndEmit:_,emit:I};function R(t){return j.indexOf(t)!==-1}const M=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function q(t){return M.includes(t)}function N(t){return["transition-group","TransitionGroup"].includes(t)}function D(t){return["id","class","role","style"].includes(t)||t.startsWith("data-")||t.startsWith("aria-")||t.startsWith("on")}function w(t){return t.reduce((e,[n,o])=>(e[n]=o,e),{})}function P({$attrs:t,componentData:e={}}){return{...w(Object.entries(t).filter(([o,r])=>D(o))),...e}}function B({$attrs:t,callBackBuilder:e}){const n=w(L(t));Object.entries(e).forEach(([r,i])=>{h[r].forEach(s=>{n[`on${s}`]=i(s)})});const o=`[data-draggable]${n.draggable||""}`;return{...n,draggable:o}}function L(t){return Object.entries(t).filter(([e,n])=>!D(e)).map(([e,n])=>[T(e),n]).filter(([e,n])=>!R(e))}const V=({el:t})=>t,H=(t,e)=>t.__draggable_context=e,S=t=>t.__draggable_context;class K{constructor({nodes:{header:e,default:n,footer:o},root:r,realList:i}){this.defaultNodes=n,this.children=[...e,...n,...o],this.externalComponent=r.externalComponent,this.rootTransition=r.transition,this.tag=r.tag,this.realList=i}get _isRootComponent(){return this.externalComponent||this.rootTransition}render(e,n){const{tag:o,children:r,_isRootComponent:i}=this;return e(o,n,i?{default:()=>r}:r)}updated(){const{defaultNodes:e,realList:n}=this;e.forEach((o,r)=>{H(V(o),{element:n[r],index:r})})}getUnderlyingVm(e){return S(e)}getVmIndexFromDomIndex(e,n){const{defaultNodes:o}=this,{length:r}=o,i=n.children,s=i.item(e);if(s===null)return r;const l=S(s);if(l)return l.index;if(r===0)return 0;const c=V(o[0]),p=[...i].findIndex(d=>d===c);return e<p?0:r}}function G(t,e){const n=t[e];return n?n():[]}function W({$slots:t,realList:e,getKey:n}){const o=e||[],[r,i]=["header","footer"].map(c=>G(t,c)),{item:s}=t;if(!s)throw new Error("draggable element must have an item slot");const l=o.flatMap((c,p)=>s({element:c,index:p}).map(d=>(d.key=n(c),d.props={...d.props||{},"data-draggable":!0},d)));if(l.length!==o.length)throw new Error("Item slot must have only one child");return{header:r,footer:i,default:l}}function z(t){const e=N(t),n=!q(t)&&!e;return{transition:e,externalComponent:n,tag:n?x(t):e?b:t}}function J({$slots:t,tag:e,realList:n,getKey:o}){const r=W({$slots:t,realList:n,getKey:o}),i=z(e);return new K({nodes:r,root:i,realList:n})}function F(t,e){m(()=>this.$emit(t.toLowerCase(),e))}function $(t){return(e,n)=>{if(this.realList!==null)return this[`onDrag${t}`](e,n)}}function Q(t){const e=$.call(this,t);return(n,o)=>{e.call(this,n,o),F.call(this,t,n)}}let g=null;const X={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:t=>t},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Y=["update:modelValue","change",...[...h.manageAndEmit,...h.emit].map(t=>t.toLowerCase())],Z=v("default",y({name:"draggable",inheritAttrs:!1,props:X,emits:Y,data(){return{error:!1}},render(){try{this.error=!1;const{$slots:t,$attrs:e,tag:n,componentData:o,realList:r,getKey:i}=this,s=J({$slots:t,tag:n,realList:r,getKey:i});this.componentStructure=s;const l=P({$attrs:e,componentData:o});return s.render(u,l)}catch(t){return this.error=!0,u("pre",{style:{color:"red"}},t.stack)}},created(){this.list!==null&&this.modelValue!==null&&U.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted(){if(this.error)return;const{$attrs:t,$el:e,componentStructure:n}=this;n.updated();const o=B({$attrs:t,callBackBuilder:{manageAndEmit:i=>Q.call(this,i),emit:i=>F.bind(this,i),manage:i=>$.call(this,i)}}),r=e.nodeType===1?e:e.parentElement;this._sortable=new f(r,o),this.targetDomElement=r,r.__draggable_component__=this},updated(){this.componentStructure.updated()},beforeUnmount(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList(){const{list:t}=this;return t||this.modelValue},getKey(){const{itemKey:t}=this;return typeof t=="function"?t:e=>e[t]}},watch:{$attrs:{handler(t){const{_sortable:e}=this;e&&L(t).forEach(([n,o])=>{e.option(n,o)})},deep:!0}},methods:{getUnderlyingVm(t){return this.componentStructure.getUnderlyingVm(t)||null},getUnderlyingPotencialDraggableComponent(t){return t.__draggable_component__},emitChanges(t){m(()=>this.$emit("change",t))},alterList(t){if(this.list){t(this.list);return}const e=[...this.modelValue];t(e),this.$emit("update:modelValue",e)},spliceList(){const t=e=>e.splice(...arguments);this.alterList(t)},updatePosition(t,e){const n=o=>o.splice(e,0,o.splice(t,1)[0]);this.alterList(n)},getRelatedContextFromMoveEvent({to:t,related:e}){const n=this.getUnderlyingPotencialDraggableComponent(t);if(!n)return{component:n};const o=n.realList,r={list:o,component:n};return t!==e&&o?{...n.getUnderlyingVm(e)||{},...r}:r},getVmIndexFromDomIndex(t){return this.componentStructure.getVmIndexFromDomIndex(t,this.targetDomElement)},onDragStart(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),g=t.item},onDragAdd(t){const e=t.item._underlying_vm_;if(e===void 0)return;a(t.item);const n=this.getVmIndexFromDomIndex(t.newIndex);this.spliceList(n,0,e);const o={element:e,newIndex:n};this.emitChanges({added:o})},onDragRemove(t){if(C(this.$el,t.item,t.oldIndex),t.pullMode==="clone"){a(t.clone);return}const{index:e,element:n}=this.context;this.spliceList(e,1);const o={element:n,oldIndex:e};this.emitChanges({removed:o})},onDragUpdate(t){a(t.item),C(t.from,t.item,t.oldIndex);const e=this.context.index,n=this.getVmIndexFromDomIndex(t.newIndex);this.updatePosition(e,n);const o={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:o})},computeFutureIndex(t,e){if(!t.element)return 0;const n=[...e.to.children].filter(s=>s.style.display!=="none"),o=n.indexOf(e.related),r=t.component.getVmIndexFromDomIndex(o);return n.indexOf(g)!==-1||!e.willInsertAfter?r:r+1},onDragMove(t,e){const{move:n,realList:o}=this;if(!n||!o)return!0;const r=this.getRelatedContextFromMoveEvent(t),i=this.computeFutureIndex(r,t),s={...this.context,futureIndex:i},l={...t,relatedContext:r,draggedContext:s};return n(l,e)},onDragEnd(){g=null}}}))}}});
//# sourceMappingURL=vuedraggable.system.min.js.map
